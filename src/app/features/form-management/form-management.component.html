<div class="main-div">

  <div class="min-w-[90%] grid grid-cols-4 gap-4">
    <mat-form-field class="col-span-3">
      <mat-label>Select Field</mat-label>
      <mat-select (selectionChange)="selectChange($event)">
        <mat-option *ngFor="let option of options" [value]="option">{{option}}</mat-option>

      </mat-select>
    </mat-form-field>
    <button mat-raised-button color=""primary class="col-span-1 !h-[57px]" (click)="addRecord()" >Add Record</button>
  </div>

  <table mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)"
    class="mat-elevation-z8 !min-w-[90%] rounded-xl">
    <ng-container *ngFor="let column of displayedColumns">
      <ng-container [matColumnDef]="column">
        <ng-contailner [ngSwitch]="column">
          <ng-container *ngSwitchCase="'action'">
            <th mat-header-cell *matHeaderCellDef mat-sort-header  style="background: transparent;"></th>
            <td mat-cell *matCellDef="let element" class="!text-center text-white">
              <ng-container *ngIf="isElementMatching(element)">
                <button mat-icon-button color="primary" (click)="isEditing ? updateRecord() : saveNewRecord()">
                  <mat-icon>save</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="cancelAdd()">
                  <mat-icon>cancel</mat-icon>
                </button>
              </ng-container>
              <ng-container *ngIf="!isElementMatching(element)">
            
                <button mat-icon-button color="primary" [matMenuTriggerFor]="menu">
                  <mat-icon>more_horiz</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button mat-menu-item (click)="editRecord(element)">Edit</button>
                  <button mat-menu-item>Item 2</button>
                </mat-menu>
              </ng-container>
            </td>
          </ng-container>

          <ng-container *ngSwitchDefault>
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="justify-items-center text-white "
              style="background: transparent;">{{column}}</th>
            <td mat-cell *matCellDef="let element ; let i = index" class="!text-center text-white">
              <ng-container *ngIf="isElementMatching(element)">
                
                  <input matInput [(ngModel)]="newRecord[column]" [name]="column + i" #newInput (focus)="onInputFocus($event)"
                    [autofocus]="i === 0" class="w-full text-center p-3 bg-gray-100 rounded-md border border-[#62656e]">
                  
                  </ng-container>
          
              <ng-container *ngIf="!isElementMatching(element)">
                {{element[column]}}
              </ng-container>
            </td>
          
          </ng-container>

        </ng-contailner>

      </ng-container>
    </ng-container>


    <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
    [class.highlight-row]="isAddingNew && row === newRecord"></tr>
  </table>
</div>